<!doctype html>
<html lang="en">
  <head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="css/style.css">

<!-- jQuery -->
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"></script>

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<!-- DataTables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">

<!-- DataTables -->

<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
    <title>Profesor</title>
    
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <style>
        
        .container{
            max-width: 960px;
        }
        body {
            margin: 0;
            padding: 0;
            font-family: 'Montserrat';
        }

        header {
            position: relative;
        }

        .encabezado-container {
            position: relative;
        }

        img {
            width: 100%;
            height: auto;
            display: block;
        }

        .barra-inferior {
            width: 100%;
            background-color: #3C5EFF;
            padding: 0px;
            box-sizing: border-box;
            text-align: center;
        }

        .boton-salir {
            background-color: transparent;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 20px;
            font-family: 'Montserrat';
            transition: background-color 0.3s, font-size 0.3s;
        }

        .boton-salir:hover {
            font-size: 24px;
            text-decoration: none;
            color: #91B4FF;
        }

        .cuadrados-container {
            text-align: center;
        }

        .cuadrado {
            margin: 10px;
            margin-top: 30px;
            background-color: #3C5EFF;
            display: inline-block;
            width: 300px;
            height: 400px;
            box-sizing: border-box;
            overflow: hidden;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
        }

        .cuadrado:hover {
            transform: scale(1.1);
        }

        .cuadrado .contenido {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 20px;
        }

        .cuadrado img {
            width: 60%;
            height: auto;
            object-fit: cover;
            border-radius: 10px;
        }

        .cuadrado:last-child {
            margin-right: 0;
        }

        .cuadrado:nth-child(1) {
            background-color: #91B4FF;
        }

        .cuadrado:nth-child(2) {
            background-color: #FF05B0;
        }

        .cuadrado:nth-child(3) {
            background-color: #3C5EFF;
        }

        .texto-adicional {
            padding: 20px;
            text-align: center;
            font-weight: bold;
            color: black;
            margin-top: 20px;
            font-family: 'Montserrat';
        }

        .paso1, .paso2, .paso3 {
            width: 100%;
            height: 200px;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 30px;
        }

        .como-funciona {
            font-weight: bold;
            font-size: 50px;
        }
        .materia-input {
            width: calc(100% - 15px);
            margin-left : 15px;
        }
        h2 {
            text-align: center;
        }

    </style>
  </head>
  <body>
    <header>
        <div class="encabezado-container">
            <img src="https://i.ibb.co/P1ytQXV/header.jpg" alt="Encabezado de la página">
        </div>
        
        <div class="barra-inferior">
            <a href="/logout" class="boton-salir">Salir</a>
        </div>


    </header>
    
    <div class="container">
        <div class="shadow-lg pb-3 mb-5 bg-body rounded">
            <br>
            <h2>Administración</h2>
            <h4>Añadir profesor</h4>
            <br>
            <form action="/crear" method="POST">
                <div class="col-md-6">
                    <label for="profesor" class="from-label">Nombre</label>
                    <input id="profesor" name="profesor" type="text" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="telefono" class="from-label">Telefono</label>
                    <input id="telefono" name="telefono" type="tel" class="form-control" required pattern="[0-9]{10}" maxlength="10">
                </div>
                <div class="col-md-6">
                    <label for="correo" class="from-label">Correo</label>
                    <input id="correo" name="correo" type="email" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="iae" class="from-label">IAE</label>
                    <input id="iae" name="iae" type="number" class="form-control" required min="0" max="10">
                </div>
                <div class="col-md-6" id="materia1-container">
                    <label for="materia1" class="form-label">Materia 1</label>
                    <input id="materia1" name="materias[]" type="text" class="form-control" required>
                    <br>
                    <button class="btn-guardar" type="button" onclick="agregarCampo()">Agregar más materias</button>
                    <br>
                    <br>
                </div>
                
                
                <button type="submit" class="w-100 btn btn-guardar btn-lg"><i class="bi bi-save"></i>Registrar</button>
            </form>
        </div>
        
        <table id="tablaProfesores" class="table mt-4">
            <thead>
                <!-- Encabezados de la tabla -->
                <tr>
                    <th style="display: none;">ID</th>
                    <th>Nombre</th>
                    <th>Telefono</th>
                    <th>Correo</th>
                    <th>IAE</th>
                    <th>Materias</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <% profesores.forEach((profesor) => { %>
                    <tr>
                        <td style="display: none;"><%= profesor._id %></td>
                        <td><%= profesor.profesor %></td>
                        <td><%= profesor.telefono %></td>
                        <td><%= profesor.correo %></td>
                        <td><%= profesor.iae %></td>
                        <td>
                            <ul>
                                <% profesor.materias.forEach((materia, index) => { %>
                                    <li><%= materia %></li>
                                <% }) %>
                            </ul>
                        </td>
                        <td>
                            <a type="button" class="btnEditar btn btn-outline-primary bi bi-pencil"></a>
                            <a href="/borrar/<%= profesor._id %>" class="btn btn-outline-danger bi bi-trash"></a>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>


<!-- Modal -->
<div class="modal fade" id="modalProfesor" tabindex="-1" aria-labelledby="modalProfesor" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="modalProfesorLabel">Editar Profesor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <form action="/editar" method="POST">
                
                    <input type="text" name="id_editar" id="id_editar" hidden>

                    <!-- Campo Profesor -->
                    <div class="mb-3">
                        <label for="Profesor_editar" class="col-form-label">Profesor</label>
                        <input type="text" id="Profesor_editar" name="Profesor_editar" class="form-control" value="">
                    </div>

                    <!-- Campo Telefono -->
                    <div class="mb-3">
                        <label for="Telefono_editar" class="col-form-label">Teléfono</label>
                        <input type="number" id="Telefono_editar" name="Telefono_editar" class="form-control" value="">
                    </div>

                    <!-- Campo Correo -->
                    <div class="mb-3">
                        <label for="Correo_editar" class="col-form-label">Correo</label>
                        <input type="text" id="Correo_editar" name="Correo_editar" class="form-control" value="">
                    </div>

                    <!-- Campo IAE -->
                    <div class="mb-3">
                        <label for="IAE_editar" class="col-form-label">IAE</label>
                        <input type="number" id="IAE_editar" name="IAE_editar" class="form-control" value="">
                    </div>

                    <!-- Campo Materias -->
                    <div class="mb-3">
                        <label for="Materias_editar" class="col-form-label">Materias (separadas por coma)</label>
                        <textarea id="Materias_editar" name="Materias_editar" class="form-control" rows="4" required></textarea>
                    </div>
                    
                    

                

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-default cerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                </div>
            </form>
            </div>
            
        </div>
    </div>
</div>


<!-- Esto lo importé para poder cerrar el modal con la función de abajo -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        $(document).ready(function() {
            var table = $('#tablaProfesores').DataTable();
        });
        </script>

    <script>
        $(document).ready(function() {
            var oldTable = $('#tablaProfesores').DataTable();
            oldTable.destroy();
            var newTable = new DataTable('#tablaProfesores', {
                // Opciones de configuración aquí
            });
        });
        </script>

    <script>
    $(document).ready(function() {
        $(".cerrarModal").click(function() {
            $("#modalContractCandidatesPre").modal('hide');
        });
    });
    </script>
    
    <script>
        let contador = 1;
        
        function agregarCampo() {
    contador++; 

    const materiaContainers = document.querySelectorAll('.materia-container');
    const lastMateriaContainer = materiaContainers[materiaContainers.length - 1];

    const divRow = document.createElement('div');
    divRow.classList.add('row');
    divRow.classList.add('materia-container'); //Clase contenedora de las materias

    const divCol = document.createElement('div');
    divCol.classList.add('col-md-6');

    const label = document.createElement('label');
    label.setAttribute('for', `materia${contador}`);
    label.classList.add('form-label');
    label.textContent = `Materia ${contador}`;

    const input = document.createElement('input');
    input.setAttribute('id', `materia${contador}`);
    input.setAttribute('name', 'materias[]');
    input.setAttribute('type', 'text');
    input.classList.add('form-control');
    input.classList.add('materia-input'); //Clase CSS para los inputs
    input.setAttribute('required', '');

    divCol.appendChild(label);
    divCol.appendChild(input);
    divRow.appendChild(divCol);

    const form = document.querySelector('form');
    form.insertBefore(divRow, form.lastElementChild);
}

    
    </script>
    
    <script src="js/code.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>

    <script>
        $(document).ready(function() {
          $('#tablaProfesores').DataTable();
        });
      </script>
      
</body>
</body>


</script>

</html>